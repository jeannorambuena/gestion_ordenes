{% extends 'base.html' %}

{% block title %}Lista de Jefaturas DAEM{% endblock %}

{% block content %}
<div class="container mt-5">
  <h2 class="text-center mb-3">Lista de Jefaturas DAEM</h2>

  <!-- Botón para agregar nueva jefatura -->
  <div class="d-flex justify-content-end mb-3">
    <a href="{{ url_for('jefatura_daem.nueva_jefatura_daem') }}" class="btn btn-success">Agregar Nueva Jefatura</a>
  </div>

  {% if datos %}
  <div class="table-responsive shadow-lg p-3 mb-5 bg-white rounded">
    <table class="table table-bordered table-hover align-middle">
      <thead class="bg-success text-white text-center">
        <tr>
          <th>Nombre</th>
          <th>RUT</th>
          <th>Cargo</th>
          <th>Fecha de Inicio</th>
          <th>Fecha de Término</th>
          <th>Email</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for item in datos %}
        <tr>
          <td>{{ item.funcionario.nombre }} {{ item.funcionario.apellido }}</td>
          <td>{{ item.funcionario.rut_cuerpo }}-{{ item.funcionario.rut_dv }}</td>
          <td>{{ item.jefatura.cargo.nombre_cargo }}</td>
          <td class="text-center">{{ item.jefatura.fecha_inicio.strftime('%d-%m-%Y') }}</td>
          <td class="text-center">
            {% if item.jefatura.fecha_termino %}
              {{ item.jefatura.fecha_termino.strftime('%d-%m-%Y') }}
            {% else %}
              N/A
            {% endif %}
          </td>
          <td>{{ item.funcionario.email or 'Sin correo' }}</td>
          <td class="text-center">
            <a href="{{ url_for('jefatura_daem.editar_jefatura_daem', id=item.jefatura.id) }}" class="btn btn-warning btn-sm me-2">Editar</a>
            <form action="{{ url_for('jefatura_daem.eliminar_jefatura_daem', id=item.jefatura.id) }}" method="POST" style="display:inline-block;">
              <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('¿Estás seguro de eliminar esta jefatura?')">Eliminar</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <div class="alert alert-info text-center" role="alert">
    No hay jefaturas registradas.
  </div>
  {% endif %}
</div>
{% endblock %}
